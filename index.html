<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T·ª´ v·ª±ng ti·∫øng Trung </title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <h1>üìö T·ª´ v·ª±ng ti·∫øng Trung</h1>

        <div class="tabs">
            <button class="tab active" onclick="showTab('vocabulary')">üìñ T·ª´ v·ª±ng</button>
            <button class="tab" onclick="showTab('add-word')">‚ûï Th√™m t·ª´ m·ªõi</button>
            <button class="tab" onclick="showTab('exercise')">‚úèÔ∏è L√†m b√†i t·∫≠p</button>
            <button class="tab" onclick="showTab('download')">üì• T·∫£i xu·ªëng</button>
        </div>

        <!-- Tab t·ª´ v·ª±ng -->
        <div id="vocabulary" class="tab-content active">
            <div class="filter-bar">
                <input id="searchInput" type="text" placeholder="T√¨m theo ch·ªØ H√°n / pinyin / nghƒ©a..."
                    aria-label="T√¨m ki·∫øm t·ª´ v·ª±ng">
                <select id="filterLesson" aria-label="L·ªçc theo b√†i h·ªçc">
                    <option value="all">T·∫•t c·∫£ b√†i</option>
                </select>
                <input id="filterTopic" type="text" placeholder="L·ªçc theo ch·ªß ƒë·ªÅ" aria-label="L·ªçc theo ch·ªß ƒë·ªÅ">
                <select id="filterGrammar" aria-label="L·ªçc theo t·ª´ lo·∫°i">
                    <option value="all">T·∫•t c·∫£ t·ª´ lo·∫°i</option>
                    <option value="N">N</option>
                    <option value="V">V</option>
                    <option value="Vs">Vs</option>
                    <option value="Vst">Vst</option>
                    <option value="Vaux">Vaux</option>
                    <option value="Adv">Adv</option>
                    <option value="Det">Det</option>
                    <option value="M">M</option>
                    <option value="Ptc">Ptc</option>
                </select>
                <select id="sortSelect" aria-label="S·∫Øp x·∫øp">
                    <option value="default">M·∫∑c ƒë·ªãnh</option>
                    <option value="chinese_asc">Ch·ªØ H√°n A‚ÜíZ</option>
                    <option value="chinese_desc">Ch·ªØ H√°n Z‚ÜíA</option>
                    <option value="pinyin_asc">Pinyin A‚ÜíZ</option>
                    <option value="pinyin_desc">Pinyin Z‚ÜíA</option>
                </select>
                <label class="inline-label"><input id="favOnly" type="checkbox" aria-label="Ch·ªâ hi·ªán t·ª´ y√™u th√≠ch"> Ch·ªâ
                    y√™u th√≠ch</label>
                <label class="inline-label"><input id="togglePinyin" type="checkbox" checked
                        aria-label="Hi·ªán ho·∫∑c ·∫©n Pinyin"> Hi·ªán Pinyin</label>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalWords">0</div>
                    <div class="stat-label">T·ªïng t·ª´ v·ª±ng</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="lessons">3</div>
                    <div class="stat-label">B√†i h·ªçc</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="categories">5</div>
                    <div class="stat-label">Ch·ªß ƒë·ªÅ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="userWords">0</div>
                    <div class="stat-label">T·ª´ t√πy ch·ªânh</div>
                </div>
            </div>

            <div class="table-container">
                <table id="vocabularyTable">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>B√†i h·ªçc</th>
                            <th>Ch·ªß ƒë·ªÅ</th>
                            <th>Ch·ªØ H√°n</th>
                            <th>Pinyin</th>
                            <th>T·ª´ lo·∫°i</th>
                            <th>Nghƒ©a ti·∫øng Vi·ªát</th>
                            <th>V√≠ d·ª•</th>
                            <th>H√†nh ƒë·ªông</th>
                        </tr>
                    </thead>
                    <tbody id="vocabularyBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tab th√™m t·ª´ m·ªõi -->
        <div id="add-word" class="tab-content">
            <div class="add-word-form">
                <h3>‚ûï Th√™m t·ª´ v·ª±ng m·ªõi</h3>
                <div class="grid-form">
                    <div class="form-group">
                        <label for="newLesson">B√†i h·ªçc:</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <select id="newLesson" style="flex: 1;">
                                <option value="B√†i 1">B√†i 1</option>
                                <option value="B√†i 2">B√†i 2</option>
                                <option value="B√†i 3">B√†i 3</option>
                                <option value="T·ª´ m·ªõi">T·ª´ m·ªõi</option>
                                <option value="custom">T·∫°o b√†i m·ªõi...</option>
                            </select>
                            <button type="button" class="btn" onclick="showCustomLessonInput()" id="customLessonBtn"
                                style="display: none; padding: 8px 16px;">
                                ‚ûï
                            </button>
                        </div>
                        <input type="text" id="customLessonInput" placeholder="Nh·∫≠p t√™n b√†i h·ªçc m·ªõi"
                            style="display: none; margin-top: 8px;">
                    </div>

                    <div class="form-group">
                        <label for="newTopic">Ch·ªß ƒë·ªÅ:</label>
                        <input type="text" id="newTopic" placeholder="V√≠ d·ª•: Gia ƒë√¨nh, Th·ª©c ƒÉn...">
                    </div>

                    <div class="form-group">
                        <label for="newChinese">Ch·ªØ H√°n:</label>
                        <input type="text" id="newChinese" placeholder="V√≠ d·ª•: ‰Ω†Â•Ω" required>
                    </div>

                    <div class="form-group">
                        <label for="newPinyin">Pinyin:</label>
                        <input type="text" id="newPinyin" placeholder="V√≠ d·ª•: n«ê h«éo" required>
                    </div>

                    <div class="form-group">
                        <label for="newGrammar">T·ª´ lo·∫°i:</label>
                        <select id="newGrammar">
                            <option value="N">N - Danh t·ª´</option>
                            <option value="V">V - ƒê·ªông t·ª´</option>
                            <option value="Vs">Vs - T√≠nh t·ª´</option>
                            <option value="Vst">Vst - ƒê·ªông t·ª´ tr·∫°ng th√°i</option>
                            <option value="Vaux">Vaux - ƒê·ªông t·ª´ ph·ª•</option>
                            <option value="Adv">Adv - Tr·∫°ng t·ª´</option>
                            <option value="Det">Det - ƒê·ªãnh t·ª´</option>
                            <option value="M">M - L∆∞·ª£ng t·ª´</option>
                            <option value="Ptc">Ptc - Ng·ªØ kh√≠ t·ª´</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="newVietnamese">Nghƒ©a ti·∫øng Vi·ªát:</label>
                        <input type="text" id="newVietnamese" placeholder="V√≠ d·ª•: Xin ch√†o" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="newExample">V√≠ d·ª•:</label>
                    <input type="text" id="newExample" placeholder="V√≠ d·ª•: ‰Ω†Â•ΩÔºÅÂæàÈ´òÂÖ¥ËßÅÂà∞‰Ω†„ÄÇ">
                </div>

                <div style="text-align: center;">
                    <button class="btn" onclick="addNewWord()">‚ûï Th√™m t·ª´ v·ª±ng</button>
                    <button class="btn" onclick="clearForm()">üîÑ X√≥a form</button>
                </div>

                <!-- Qu·∫£n l√Ω d·ªØ li·ªáu c√° nh√¢n -->
                <div class="data-manager">
                    <h4 class="data-title">üìÅ Qu·∫£n l√Ω d·ªØ li·ªáu c√° nh√¢n</h4>
                    <div class="data-container">

                        <!-- Export Section -->
                        <div class="data-section">
                            <h5 class="data-section-title export">üì§ Xu·∫•t d·ªØ li·ªáu</h5>
                            <div class="data-actions">
                                <button class="btn btn-excel" onclick="exportUserDataExcel()">üìä Export Excel
                                    (.xlsx)</button>
                                <button class="btn btn-json" onclick="exportUserData()">üíæ Export JSON (.json)</button>
                            </div>
                        </div>

                        <!-- Import Section -->
                        <div class="data-section">
                            <h5 class="data-section-title import">üì• Nh·∫≠p d·ªØ li·ªáu</h5>
                            <div class="data-actions">
                                <button class="btn btn-import-excel" onclick="importUserDataExcel()">üìã Import Excel
                                    (.xlsx)</button>
                                <button class="btn btn-import-json" onclick="importUserData()">üìÇ Import JSON
                                    (.json)</button>
                            </div>
                        </div>
                    </div>

                    <!-- Danger Zone -->
                    <div class="danger-zone">
                        <h5>‚ö†Ô∏è V√πng nguy hi·ªÉm</h5>
                        <button class="btn btn-danger" onclick="clearLocalStorage()">üóëÔ∏è X√≥a t·∫•t c·∫£ t·ª´ ƒë√£ th√™m</button>
                    </div>

                    <div class="info-box">
                        <p>
                            <strong>üí° H∆∞·ªõng d·∫´n:</strong><br>
                            ‚Ä¢ <strong>Excel:</strong> D·ªÖ ch·ªânh s·ª≠a, c√≥ th·ªÉ m·ªü b·∫±ng Google Sheets, Excel<br>
                            ‚Ä¢ <strong>JSON:</strong> ƒê·ªãnh d·∫°ng nh·∫π, t∆∞∆°ng th√≠ch cao<br>
                            ‚Ä¢ <strong>D·ªØ li·ªáu:</strong> T·ª± ƒë·ªông l∆∞u tr√™n tr√¨nh duy·ªát, export ƒë·ªÉ backup
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab l√†m b√†i t·∫≠p -->
        <div id="exercise" class="tab-content">
            <div class="exercise-section">
                <h3>‚úèÔ∏è L√†m b√†i t·∫≠p v·ªõi ki·ªÉm tra t·ª©c th√¨</h3>

                <div class="exercise-controls">
                    <select id="exerciseType">
                        <option value="fillBlank">ƒêi·ªÅn ch·ªØ H√°n</option>
                        <option value="fillVietnamese">ƒêi·ªÅn nghƒ©a ti·∫øng Vi·ªát</option>
                        <option value="fillPinyin">ƒêi·ªÅn Pinyin</option>
                        <option value="multipleChoice">Tr·∫Øc nghi·ªám ch·ªØ H√°n</option>
                        <option value="multipleChoiceVietnamese">Tr·∫Øc nghi·ªám nghƒ©a</option>
                        <option value="trueFalse">ƒê√∫ng/Sai</option>
                        <option value="matching">N·ªëi t·ª´</option>
                        <option value="listening">Nghe Pinyin</option>
                        <option value="buildSentence">Gh√©p c√¢u</option>
                    </select>

                    <select id="lessonFilter">
                        <option value="all">T·∫•t c·∫£ b√†i</option>
                        <option value="B√†i 1">B√†i 1</option>
                        <option value="B√†i 2">B√†i 2</option>
                        <option value="T·ª´ m·ªõi">T·ª´ m·ªõi</option>
                    </select>

                    <input type="number" id="questionCount" min="5" max="50" value="10"
                        style="width: 80px; padding: 10px; border-radius: 20px; border: 2px solid #ddd;">
                    <label for="questionCount">c√¢u</label>

                    <button class="btn" onclick="startExercise()">üéØ B·∫Øt ƒë·∫ßu l√†m b√†i</button>
                    <button class="btn" onclick="resetExercise()">üîÑ L√†m l·∫°i</button>
                </div>

                <div id="exerciseContainer" style="display: none;">
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
                    </div>

                    <div class="score-display">
                        <span style="color: #4caf50;">‚úÖ ƒê√∫ng: <span id="correctCount">0</span></span>
                        <span style="margin: 0 20px;">|</span>
                        <span style="color: #f44336;">‚ùå Sai: <span id="incorrectCount">0</span></span>
                        <span style="margin: 0 20px;">|</span>
                        <span>C√¢u <span id="currentQuestion">1</span>/<span id="totalQuestions">0</span></span>
                    </div>

                    <div id="questionCard" class="question-card"></div>

                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn" onclick="previousQuestion()" id="prevBtn">‚¨ÖÔ∏è C√¢u tr∆∞·ªõc</button>
                        <button class="btn" onclick="nextQuestion()" id="nextBtn">C√¢u sau ‚û°Ô∏è</button>
                        <button class="btn" onclick="finishExercise()" id="finishBtn" style="display: none;">üèÅ K·∫øt
                            th√∫c</button>
                    </div>
                </div>

                <div id="exerciseResults"
                    style="display: none; margin-top: 20px; padding: 20px; background: white; border-radius: 10px;">
                    <h4>üéâ Ho√†n th√†nh b√†i t·∫≠p!</h4>
                    <div id="finalScore" style="font-size: 24px; font-weight: bold; margin: 15px 0;"></div>
                    <div id="encouragement" style="font-size: 18px; margin: 15px 0;"></div>
                    <button class="btn" onclick="reviewMistakes()" id="reviewBtn">üìù Xem l·∫°i c√¢u sai</button>
                    <button class="btn" onclick="showHistory()" id="historyBtn">üìú L·ªãch s·ª≠ b√†i l√†m</button>
                </div>
            </div>

            <div class="history-section">
                <div class="history-header">
                    <h4>üìú L·ªãch s·ª≠ b√†i t·∫≠p</h4>
                    <div>
                        <button class="btn" onclick="exportHistory()" style="padding: 8px 14px;">üíæ Export</button>
                        <button class="btn btn-danger" onclick="clearHistory()" style="padding: 8px 14px;">üóëÔ∏è X√≥a l·ªãch
                            s·ª≠</button>
                    </div>
                </div>
                <div id="historyList" class="history-list"></div>
            </div>
        </div>

        <!-- Tab t·∫£i xu·ªëng -->
        <div id="download" class="tab-content">
            <div
                style="text-align: center; padding: 30px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 15px;">
                <h3>üì• T·∫£i xu·ªëng file Excel</h3>
                <p>File Excel s·∫Ω bao g·ªìm t·∫•t c·∫£ t·ª´ v·ª±ng v·ªõi c√°c worksheet ri√™ng bi·ªát cho t·ª´ng b√†i h·ªçc</p>
                <button class="btn" onclick="downloadExcel()">üìä T·∫£i Excel - T·∫•t c·∫£ t·ª´ v·ª±ng</button>
                <button class="btn" onclick="downloadFlashcards()">üÉè T·∫£i Excel - Flashcards</button>
                <button class="btn" onclick="downloadExercises()">‚úèÔ∏è T·∫£i Excel - B√†i t·∫≠p t·ª± ƒë·ªông</button>
            </div>
        </div>
    </div>

    <!-- Modal xem l·∫°i c√¢u sai -->
    <!-- Modal ch·ªânh s·ª≠a t·ª´ v·ª±ng -->
    <div id="reviewModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeReviewModal()">&times;</span>
            <h3>üìù Xem l·∫°i c√¢u sai</h3>
            <div id="reviewContent"></div>
        </div>
    </div>

    <!-- Modal l·ªãch s·ª≠ chi ti·∫øt -->
    <div id="historyModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <span class="close" onclick="closeHistoryModal()">&times;</span>
            <h3>üìú Chi ti·∫øt b√†i l√†m</h3>
            <div id="historyDetail"></div>
        </div>
    </div>

    <!-- Modal ch·ªânh s·ª≠a t·ª´ v·ª±ng -->
    <div id="editModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closeEditModal()">&times;</span>
            <h3>‚úèÔ∏è Ch·ªânh s·ª≠a t·ª´ v·ª±ng</h3>
            <form id="editForm" style="text-align: left;">
                <div class="grid-form">
                    <div class="form-group">
                        <label for="editLesson">B√†i h·ªçc:</label>
                        <select id="editLesson">
                            <option value="B√†i 1">B√†i 1</option>
                            <option value="B√†i 2">B√†i 2</option>
                            <option value="B√†i 3">B√†i 3</option>
                            <option value="T·ª´ m·ªõi">T·ª´ m·ªõi</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="editTopic">Ch·ªß ƒë·ªÅ:</label>
                        <input type="text" id="editTopic" placeholder="V√≠ d·ª•: Gia ƒë√¨nh, Th·ª©c ƒÉn...">
                    </div>

                    <div class="form-group">
                        <label for="editChinese">Ch·ªØ H√°n:</label>
                        <input type="text" id="editChinese" placeholder="V√≠ d·ª•: ‰Ω†Â•Ω" required>
                    </div>

                    <div class="form-group">
                        <label for="editPinyin">Pinyin:</label>
                        <input type="text" id="editPinyin" placeholder="V√≠ d·ª•: n«ê h«éo" required>
                    </div>

                    <div class="form-group">
                        <label for="editGrammar">T·ª´ lo·∫°i:</label>
                        <select id="editGrammar">
                            <option value="N">N - Danh t·ª´</option>
                            <option value="V">V - ƒê·ªông t·ª´</option>
                            <option value="Vs">Vs - T√≠nh t·ª´</option>
                            <option value="Vst">Vst - ƒê·ªông t·ª´ tr·∫°ng th√°i</option>
                            <option value="Vaux">Vaux - ƒê·ªông t·ª´ ph·ª•</option>
                            <option value="Adv">Adv - Tr·∫°ng t·ª´</option>
                            <option value="Det">Det - ƒê·ªãnh t·ª´</option>
                            <option value="M">M - L∆∞·ª£ng t·ª´</option>
                            <option value="Ptc">Ptc - Ng·ªØ kh√≠ t·ª´</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="editVietnamese">Nghƒ©a ti·∫øng Vi·ªát:</label>
                        <input type="text" id="editVietnamese" placeholder="V√≠ d·ª•: Xin ch√†o" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="editExample">V√≠ d·ª•:</label>
                    <input type="text" id="editExample" placeholder="V√≠ d·ª•: ‰Ω†Â•ΩÔºÅÂæàÈ´òÂÖ¥ËßÅÂà∞‰Ω†„ÄÇ">
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button type="button" class="btn" onclick="saveEditedWord()">üíæ L∆∞u thay ƒë·ªïi</button>
                    <button type="button" class="btn" onclick="closeEditModal()"
                        style="background: linear-gradient(45deg, #757575, #616161);">‚ùå H·ªßy</button>
                </div>
            </form>
        </div>
    </div>
    <script src="script.js"></script>
</body>

</html>